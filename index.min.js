!function(){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});for(var s,t=["webkit","moz"],e=0;e<t.length&&!window.requestAnimationFrame;++e){var i=t[e];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(s=0,window.requestAnimationFrame=function(t){var e=Date.now(),i=Math.max(s+16,e);return setTimeout(function(){t(s=i)},i-e)},window.cancelAnimationFrame=clearTimeout)}(),function(){function r(t,e,i){return t.addEventListener(e,i,!1),function(){t.removeEventListener(e,i,!1)}}function n(t){return Math.sqrt(1-Math.pow(t-1,2))}function h(t){return 1-Math.sqrt(1-t*t)}function o(){}function t(t){this.reverse=this._getValue(t.reverse,!1),this.element="string"==typeof t.touch?document.querySelector(t.touch):t.touch,this.target=this._getValue(t.target,this.element);var e=this._getValue(t.followers,[]);this.followers=e.map(function(t){return{element:"string"==typeof t.element?document.querySelector(t.element):t.element,offset:t.offset}}),this.vertical=this._getValue(t.vertical,!0),this.property=t.property,this.tickID=0,this.value=this._getValue(t.value,this.target[this.property]),this.target[this.property]=this.value,this.followers.forEach(function(t){t.element[this.property]=this.value+t.offset}.bind(this)),this.fixed=this._getValue(t.fixed,!1),this.sensitivity=this._getValue(t.sensitivity,1),this.moveFactor=this._getValue(t.moveFactor,1),this.factor=this._getValue(t.factor,1),this.outFactor=this._getValue(t.outFactor,.3),this.min=t.min,this.max=t.max,this.deceleration=this._getValue(t.deceleration,6e-4),this.maxRegion=this._getValue(t.maxRegion,600),this.springMaxRegion=this._getValue(t.springMaxRegion,60),this.maxSpeed=t.maxSpeed,this.hasMaxSpeed=!(void 0===this.maxSpeed),this.lockDirection=this._getValue(t.lockDirection,!0),this.change=t.change||o,this.touchEnd=t.touchEnd||o,this.touchStart=t.touchStart||o,this.touchMove=t.touchMove||o,this.touchCancel=t.touchCancel||o,this.reboundEnd=t.reboundEnd||o,this.animationEnd=t.animationEnd||o,this.correctionEnd=t.correctionEnd||o,this.tap=t.tap||o,this.pressMove=t.pressMove||o,this.shouldRebound=t.shouldRebound||function(){return!0},this.preventDefault=this._getValue(t.preventDefault,!0),this.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},this.hasMin=!(void 0===this.min),this.hasMax=!(void 0===this.max),this.isTouchStart=!1,this.step=t.step,this.inertia=this._getValue(t.inertia,!0),this._calculateIndex(),this.eventTarget=window,t.bindSelf&&(this.eventTarget=this.element);var i=this,s=this._events;!function t(e){return i[e]=i[e].bind(i),t}("_start")("_end")("_cancel");var n=r(this.element,s.start,this._start),h=r(this.eventTarget,s.end,this._end),a=r(this.eventTarget,s.cancel,this._cancel);this.destory=function(){n(),h(),a(),i.eventTarget.removeEventListener(s.move,i._moveHandler),i.followers=i.element=i.target=null,cancelAnimationFrame(i.tickID)},this.eventTarget.addEventListener(s.move,this._moveHandler,{passive:!1,capture:!1}),this.x1=this.x2=this.y1=this.y2=null}t.prototype={_events:"PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator?{start:"pointerdown",move:"pointermove",end:"pointerend",cancel:"pointercancel"}:"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints?{start:"touchstart",move:"touchmove",end:"touchend",cancel:"touchcancel"}:{start:"mousedown",move:"mousemove",end:"mouseup",cancel:"mouseup"},isAtMax:function(){return this.hasMax&&this.target[this.property]>=this.max},isAtMin:function(){return this.hasMin&&this.target[this.property]<=this.min},_getValue:function(t,e){return void 0===t?e:t},stop:function(){cancelAnimationFrame(this.tickID),this._calculateIndex()},_start:function(t){var e=t.touches?t.touches[0]:t;this.isTouchStart=!0,this.touchStart.call(this,t,this.target[this.property]),cancelAnimationFrame(this.tickID),this._calculateIndex(),this.startTime=(new Date).getTime(),this.x1=this.preX=e.pageX,this.y1=this.preY=e.pageY,this.start=this.vertical?this.preY:this.preX,this._firstTouchMove=!0,this._preventMove=!1},_move:function(t){var e,i,s,n,h=t.touches?t.touches[0]:t;this.isTouchStart&&(e=t.touches?t.touches.length:1,i=h.pageX,currentY=h.pageY,this._firstTouchMove&&this.lockDirection&&((0<(s=Math.abs(i-this.x1)-Math.abs(currentY-this.y1))&&this.vertical||s<0&&!this.vertical)&&(this._preventMove=!0),this._firstTouchMove=!1),this._preventMove||(h=(this.vertical?currentY-this.preY:i-this.preX)*this.sensitivity,s=this.moveFactor,(this.isAtMax()&&0<(this.reverse?-h:h)||this.isAtMin()&&(this.reverse?-h:h)<0)&&(s=this.outFactor),h*=s,this.preX=i,this.preY=currentY,this.fixed||(n=this.reverse?-h:h,this.target[this.property]+=n,this.followers.forEach(function(t){t.element[this.property]+=n}.bind(this))),this.change.call(this,this.target[this.property]),300<(h=(new Date).getTime())-this.startTime&&(this.startTime=h,this.start=this.vertical?this.preY:this.preX),this.touchMove.call(this,t,this.target[this.property])),this.preventDefault&&!function(t,e){for(var i in e)if(e[i].test(t[i]))return 1}(t.target,this.preventDefaultException)&&t.preventDefault(),1===e&&(null!==this.x2?(t.deltaX=i-this.x2,t.deltaY=currentY-this.y2):(t.deltaX=0,t.deltaY=0),this.pressMove.call(this,t,this.target[this.property])),this.x2=i,this.y2=currentY)},_cancel:function(t){var e=this.target[this.property];this.touchCancel.call(this,t,e),this._end(t)},to:function(t,e,i,s){this._to(t,this._getValue(e,600),i||n,this.change,function(t){this._calculateIndex(),this.reboundEnd.call(this,t),this.animationEnd.call(this,t),s&&s.call(this,t)}.bind(this))},_calculateIndex:function(){this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max-this.target[this.property])/this.step))},_end:function(t){var e=t.changedTouches?t.changedTouches[0]:t;if(this.isTouchStart){this.isTouchStart=!1;t.changedTouches;var i,s=e.pageX,e=e.pageY;if(self=this,current=this.target[this.property],triggerTap=Math.abs(s-this.x1)<30&&Math.abs(e-this.y1)<30,triggerTap&&this.tap.call(this,t,current),!1===this.touchEnd.call(this,t,current,this.currentPage))return;if(this.hasMax&&current>this.max){if(!this.shouldRebound(current))return;this._to(this.max,200,n,this.change,function(t){this.reboundEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this))}else if(this.hasMin&&current<this.min){if(!this.shouldRebound(current))return;this._to(this.min,200,n,this.change,function(t){this.reboundEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this))}else this.inertia&&!triggerTap&&!this._preventMove&&!this.fixed&&(i=(new Date).getTime()-this.startTime)<300?(t=((this.vertical?e:s)-this.start)*this.sensitivity,e=Math.abs(t)/i,s=this.factor*e,this.hasMaxSpeed&&s>this.maxSpeed&&(s=this.maxSpeed),i=t<0?-1:1,this.reverse&&(i=-i),t=1,(i=current+s*s/(2*this.deceleration)*i)<this.min?i=i<this.min-this.maxRegion?(t=h((current-this.min+this.springMaxRegion)/(current-i)),this.min-this.springMaxRegion):(t=h((current-this.min+this.springMaxRegion*(this.min-i)/this.maxRegion)/(current-i)),this.min-this.springMaxRegion*(this.min-i)/this.maxRegion):i>this.max&&(i=i>this.max+this.maxRegion?(t=h((this.max+this.springMaxRegion-current)/(i-current)),this.max+this.springMaxRegion):(t=h((this.max+this.springMaxRegion*(i-this.max)/this.maxRegion-current)/(i-current)),this.max+this.springMaxRegion*(i-this.max)/this.maxRegion)),t=Math.round(e/self.deceleration)*t,isNaN(i)||self._to(Math.round(i),t,n,self.change,function(t){if(self.hasMax&&self.target[self.property]>self.max){if(!this.shouldRebound(self.target[self.property]))return;cancelAnimationFrame(self.tickID),self._to(self.max,600,n,self.change,self.animationEnd)}else if(self.hasMin&&self.target[self.property]<self.min){if(!this.shouldRebound(self.target[self.property]))return;cancelAnimationFrame(self.tickID),self._to(self.min,600,n,self.change,self.animationEnd)}else self.step?self._correction():self.animationEnd.call(self,t);self.change.call(this,t)})):self._correction()}this.x1=this.x2=this.y1=this.y2=null},_to:function(i,s,n,h,a){var r=this.target,o=this.property,c=this.followers,l=r[o],u=i-l,m=+new Date,d=this,p=function(){var t=+new Date-m;if(s<=t)return r[o]=i,h&&h.call(d,i),void(a&&a.call(d,i));var e=u*n(t/s)+l;r[o]=e,c.forEach(function(t){t.element[o]=e+t.offset}),d.tickID=requestAnimationFrame(p),h&&h.call(d,r[o])};p()},_correction:function(){var t,e,i;void 0!==this.step&&(t=this.target[this.property],e=Math.floor(Math.abs(t/this.step)),i=t%this.step,Math.abs(i)>this.step/2?this._to((t<0?-1:1)*(e+1)*this.step,400,n,this.change,function(t){this._calculateIndex(),this.correctionEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this)):this._to((t<0?-1:1)*e*this.step,400,n,this.change,function(t){this._calculateIndex(),this.correctionEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this)))},destory:o},"undefined"!=typeof module&&"object"==typeof exports?module.exports=t:window.PhyTouch=t}();