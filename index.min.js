!function(){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});for(var t=["webkit","moz"],i=0;i<t.length&&!window.requestAnimationFrame;++i){var e=t[i];window.requestAnimationFrame=window[e+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e+"CancelAnimationFrame"]||window[e+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var s=0;window.requestAnimationFrame=function(t){var i=Date.now(),e=Math.max(s+16,i);return setTimeout((function(){t(s=e)}),e-i)},window.cancelAnimationFrame=clearTimeout}}(),function(){function t(t,i,e,s){var n=s||!1;return t.addEventListener(i,e,n),function(){t.removeEventListener(i,e,n)}}function i(t){return Math.sqrt(1-Math.pow(t-1,2))}function e(t){return 1-Math.sqrt(1-t*t)}function s(){const t=["down","move","up","cancel"];return"PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator?t.map((t=>"pointer"+t)):"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?["touchstart","touchmove","touchend","touchcancel"]:t.map((t=>"mouse"+t))}var n=s(),h=function(){},a=function(i){this.reverse=this._getValue(i.reverse,!1),this.element="string"==typeof i.touch?document.querySelector(i.touch):i.touch,this.target=this._getValue(i.target,this.element);var e=this._getValue(i.followers,[]);this.followers=e.map((function(t){return{element:"string"==typeof t.element?document.querySelector(t.element):t.element,offset:t.offset}})),this.vertical=this._getValue(i.vertical,!0),this.property=i.property,this.tickID=0,this.value=this._getValue(i.value,this.target[this.property]),this.target[this.property]=this.value,this.followers.forEach(function(t){t.element[this.property]=this.value+t.offset}.bind(this)),this.fixed=this._getValue(i.fixed,!1),this.sensitivity=this._getValue(i.sensitivity,1),this.moveFactor=this._getValue(i.moveFactor,1),this.factor=this._getValue(i.factor,1),this.outFactor=this._getValue(i.outFactor,.3),this.min=i.min,this.max=i.max,this.deceleration=this._getValue(i.deceleration,6e-4),this.maxRegion=this._getValue(i.maxRegion,600),this.springMaxRegion=this._getValue(i.springMaxRegion,60),this.maxSpeed=i.maxSpeed,this.hasMaxSpeed=!(void 0===this.maxSpeed),this.lockDirection=this._getValue(i.lockDirection,!0);this.change=i.change||h,this.touchEnd=i.touchEnd||h,this.touchStart=i.touchStart||h,this.touchMove=i.touchMove||h,this.touchCancel=i.touchCancel||h,this.reboundEnd=i.reboundEnd||h,this.animationEnd=i.animationEnd||h,this.correctionEnd=i.correctionEnd||h,this.tap=i.tap||h,this.pressMove=i.pressMove||h,this.shouldRebound=i.shouldRebound||function(){return!0},this.preventDefault=this._getValue(i.preventDefault,!0),this.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},this.hasMin=!(void 0===this.min),this.hasMax=!(void 0===this.max),this.isTouchStart=!1,this.step=i.step,this.inertia=this._getValue(i.inertia,!0),this._calculateIndex(),this.eventTarget=window,i.bindSelf&&(this.eventTarget=this.element);var s=this;!function t(i){return s[i]=s[i].bind(s),t}("_start")("_end")("_cancel")("_move");var a=t(this.element,n[0],this._start),r=t(this.eventTarget,n[1],this._move,{passive:!1,capture:!1}),o=t(this.eventTarget,n[2],this._end),c=t(this.eventTarget,n[3],this._cancel);this.destory=function(){a(),r(),o(),c(),s.followers=s.element=s.target=null,cancelAnimationFrame(s.tickID)},this.x1=this.x2=this.y1=this.y2=null};a.prototype={_events:s(),isAtMax:function(){return this.hasMax&&this.target[this.property]>=this.max},isAtMin:function(){return this.hasMin&&this.target[this.property]<=this.min},_getValue:function(t,i){return void 0===t?i:t},stop:function(){cancelAnimationFrame(this.tickID),this._calculateIndex()},_start:function(t){var i=t.touches?t.touches[0]:t;this.isTouchStart=!0,this.touchStart.call(this,t,this.target[this.property]),cancelAnimationFrame(this.tickID),this._calculateIndex(),this.startTime=(new Date).getTime(),this.x1=this.preX=i.pageX,this.y1=this.preY=i.pageY,this.start=this.vertical?this.preY:this.preX,this._firstTouchMove=!0,this._preventMove=!1},_move:function(t){if(this.isTouchStart){var i=t.touches?t.touches[0]:t,e=t.touches?t.touches.length:1,s=i.pageX;if(currentY=i.pageY,this._firstTouchMove&&this.lockDirection){var n=Math.abs(s-this.x1)-Math.abs(currentY-this.y1);(n>0&&this.vertical||n<0&&!this.vertical)&&(this._preventMove=!0),this._firstTouchMove=!1}if(!this._preventMove){var h=(this.vertical?currentY-this.preY:s-this.preX)*this.sensitivity,a=this.moveFactor;if((this.isAtMax()&&(this.reverse?-h:h)>0||this.isAtMin()&&(this.reverse?-h:h)<0)&&(a=this.outFactor),h*=a,this.preX=s,this.preY=currentY,!this.fixed){var r=this.reverse?-h:h;this.target[this.property]+=r,this.followers.forEach(function(t){t.element[this.property]+=r}.bind(this))}this.change.call(this,this.target[this.property]);var o=(new Date).getTime();o-this.startTime>300&&(this.startTime=o,this.start=this.vertical?this.preY:this.preX),this.touchMove.call(this,t,this.target[this.property])}this.preventDefault&&!function(t,i){for(var e in i)if(i[e].test(t[e]))return!0;return!1}(t.target,this.preventDefaultException)&&t.preventDefault(),1===e&&(null!==this.x2?(t.deltaX=s-this.x2,t.deltaY=currentY-this.y2):(t.deltaX=0,t.deltaY=0),this.pressMove.call(this,t,this.target[this.property])),this.x2=s,this.y2=currentY}},_cancel:function(t){var i=this.target[this.property];this.touchCancel.call(this,t,i),this._end(t)},to:function(t,e,s,n){this._to(t,this._getValue(e,600),s||i,this.change,function(t){this._calculateIndex(),this.reboundEnd.call(this,t),this.animationEnd.call(this,t),n&&n.call(this,t)}.bind(this))},_calculateIndex:function(){this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max-this.target[this.property])/this.step))},_end:function(t){var s=t.changedTouches?t.changedTouches[0]:t;if(this.isTouchStart){this.isTouchStart=!1;var n=s.pageX,h=s.pageY;if(self=this,current=this.target[this.property],triggerTap=Math.abs(n-this.x1)<30&&Math.abs(h-this.y1)<30,triggerTap&&this.tap.call(this,t,current),!1===this.touchEnd.call(this,t,current,this.currentPage))return;if(this.hasMax&&current>this.max){if(!this.shouldRebound(current))return;this._to(this.max,200,i,this.change,function(t){this.reboundEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this))}else if(this.hasMin&&current<this.min){if(!this.shouldRebound(current))return;this._to(this.min,200,i,this.change,function(t){this.reboundEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this))}else if(!this.inertia||triggerTap||this._preventMove||this.fixed)self._correction();else{var a=(new Date).getTime()-this.startTime;if(a<300){var r=((this.vertical?h:n)-this.start)*this.sensitivity,o=Math.abs(r)/a,c=this.factor*o;this.hasMaxSpeed&&c>this.maxSpeed&&(c=this.maxSpeed);var l=r<0?-1:1;this.reverse&&(l=-l);var u=current+c*c/(2*this.deceleration)*l,f=1;u<this.min?u<this.min-this.maxRegion?(f=e((current-this.min+this.springMaxRegion)/(current-u)),u=this.min-this.springMaxRegion):(f=e((current-this.min+this.springMaxRegion*(this.min-u)/this.maxRegion)/(current-u)),u=this.min-this.springMaxRegion*(this.min-u)/this.maxRegion):u>this.max&&(u>this.max+this.maxRegion?(f=e((this.max+this.springMaxRegion-current)/(u-current)),u=this.max+this.springMaxRegion):(f=e((this.max+this.springMaxRegion*(u-this.max)/this.maxRegion-current)/(u-current)),u=this.max+this.springMaxRegion*(u-this.max)/this.maxRegion));var m=Math.round(o/self.deceleration)*f;isNaN(u)||self._to(Math.round(u),m,i,self.change,(function(t){if(self.hasMax&&self.target[self.property]>self.max){if(!this.shouldRebound(self.target[self.property]))return;cancelAnimationFrame(self.tickID),self._to(self.max,600,i,self.change,self.animationEnd)}else if(self.hasMin&&self.target[self.property]<self.min){if(!this.shouldRebound(self.target[self.property]))return;cancelAnimationFrame(self.tickID),self._to(self.min,600,i,self.change,self.animationEnd)}else self.step?self._correction():self.animationEnd.call(self,t);self.change.call(this,t)}))}else self._correction()}}this.x1=this.x2=this.y1=this.y2=null},_to:function(t,i,e,s,n){var h=this.target,a=this.property,r=this.followers,o=h[a],c=t-o,l=+new Date,u=this,f=function(){var m=+new Date-l;if(m>=i)return h[a]=t,s&&s.call(u,t),void(n&&n.call(u,t));var p=c*e(m/i)+o;h[a]=p,r.forEach((function(t){t.element[a]=p+t.offset})),u.tickID=requestAnimationFrame(f),s&&s.call(u,h[a])};f()},_correction:function(){if(void 0!==this.step){var t=this.target[this.property],e=Math.floor(Math.abs(t/this.step)),s=t%this.step;Math.abs(s)>this.step/2?this._to((t<0?-1:1)*(e+1)*this.step,400,i,this.change,function(t){this._calculateIndex(),this.correctionEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this)):this._to((t<0?-1:1)*e*this.step,400,i,this.change,function(t){this._calculateIndex(),this.correctionEnd.call(this,t),this.animationEnd.call(this,t)}.bind(this))}},destory:h},"undefined"!=typeof module&&"object"==typeof exports?module.exports=a:window.PhyTouch=a}();